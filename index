<!DOCTYPE html>
<html>
<head>
<title>Questionario Fibromialgia</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; }
  .question-section { border: 1px solid #ccc; padding: 20px; margin-bottom: 20px; border-radius: 8px; }
  h2 { color: #004d99; }
  ul { list-style-type: none; padding: 0; }
  li { margin-bottom: 10px; }
  .pain-area { display: inline-block; width: 45%; }
  input[type="checkbox"] { margin-right: 10px; }
  .score { margin-top: 20px; font-weight: bold; }
  .diagnosis-result { font-weight: bold; font-size: 1.2em; margin-top: 10px; }
  .diagnosis-met { color: red; }
  .diagnosis-not-met { color: blue; }
</style>
</head>
<body>

<h1>Criteri diagnostici 2016 (Fibromyalgia Severity Scale)</h1>

<div class="question-section">
  <h2>Indice di Diffusione del Dolore (Widespread Pain Index-WPI)</h2>
  <p>(1 punto per ogni casella spuntata; Range di punteggio: 0-19)</p>
  <p>1- Indicare se si è provato dolore o indolenzimento nel corso degli ultimi 7 giorni, nelle aree riportate. Spuntare le caselle in corrispondenza di ogni area interessata da dolore o dall'indolenzimento.</p>

  <form id="fibromyalgia-form">
    <ul>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Cingolo scapolare sinistro"> Cingolo scapolare sinistro</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Anca (gluteo, trocantere) sinistra"> Anca (gluteo, trocantere) sinistra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Mascellla sinistra"> Mascella sinistra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Cingolo scapolare destro"> Cingolo scapolare destro</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Anca (gluteo, trocantere) destra"> Anca (gluteo, trocantere) destra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Mascella destra"> Mascella destra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Braccio sinistro"> Braccio sinistro</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Coscia sinistra"> Coscia sinistra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Torace"> Torace</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Braccio destro"> Braccio destro</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Coscia destra"> Coscia destra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Addome"> Addome</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Avambraccio sinistro"> Avambraccio sinistro</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Gamba sinistra"> Gamba sinistra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Area Dorsale"> Area Dorsale</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Avambraccio destro"> Avambraccio destro</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Gamba destra"> Gamba destra</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Area Lombare"> Area Lombare</label></li>
      <li class="pain-area"><label><input type="checkbox" name="pain_area" value="Collo"> Collo</label></li>
    </ul>
    <p class="score">Punteggio WPI: <span id="wpi-score">0</span> /19 aree</p>
  </form>
</div>
<hr>

<div class="question-section">
  <h2>Indice di Gravità dei Sintomi (Symptom Severity Scale-SSS)</h2>
  <p>(Range di punteggio: 0-12)</p>
  <p>2- Per ognuno dei sintomi elencati esprimere la loro gravità nel corso degli ultimi 7 giorni, utilizzando la scala di seguito riportata.</p>
  <p><strong>0=</strong> Nessun problema</p>
  <p><strong>1=</strong> Problema lieve: generalmente lieve e intermittente</p>
  <p><strong>2=</strong> Problema moderato: disturbo di considerevole entità; presente spesso e/o di grado moderato</p>
  <p><strong>3=</strong> Problema grave: continuo, che ostacola le attività della vita quotidiana</p>

  <form id="sss-form">
    <table>
      <tr>
        <td></td>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
      </tr>
      <tr>
        <td>A. Astenia, spossatezza</td>
        <td><label><input type="radio" name="symptom_A" value="0"></label></td>
        <td><label><input type="radio" name="symptom_A" value="1"></label></td>
        <td><label><input type="radio" name="symptom_A" value="2"></label></td>
        <td><label><input type="radio" name="symptom_A" value="3"></label></td>
      </tr>
      <tr>
        <td>B. Difficoltà di concentrazione, perdita di memoria</td>
        <td><label><input type="radio" name="symptom_B" value="0"></label></td>
        <td><label><input type="radio" name="symptom_B" value="1"></label></td>
        <td><label><input type="radio" name="symptom_B" value="2"></label></td>
        <td><label><input type="radio" name="symptom_B" value="3"></label></td>
      </tr>
      <tr>
        <td>C. Stanchezza al risveglio, sonno non ristoratore</td>
        <td><label><input type="radio" name="symptom_C" value="0"></label></td>
        <td><label><input type="radio" name="symptom_C" value="1"></label></td>
        <td><label><input type="radio" name="symptom_C" value="2"></label></td>
        <td><label><input type="radio" name="symptom_C" value="3"></label></td>
      </tr>
    </table>
    <p class="score">Punteggio SSS: <span id="sss-score">0</span> /12</p>
  </form>
</div>
<hr>

<div class="question-section">
  <h2>Criteri aggiuntivi (senza punteggio)</h2>
  <p>3- Indicare la presenza o assenza dei 3 sintomi (D, E, F) negli ultimi sei mesi</p>
  <p><strong>Assente:</strong> 0 | <strong>Presente:</strong> 1</p>

  <form>
    <table>
      <tr>
        <td></td>
        <td>Assente (0)</td>
        <td>Presente (1)</td>
      </tr>
      <tr>
        <td>D. Dolori o crampi addominali</td>
        <td><label><input type="radio" name="additional_symptom_D" value="0"></label></td>
        <td><label><input type="radio" name="additional_symptom_D" value="1"></label></td>
      </tr>
      <tr>
        <td>E. Depressione</td>
        <td><label><input type="radio" name="additional_symptom_E" value="0"></label></td>
        <td><label><input type="radio" name="additional_symptom_E" value="1"></label></td>
      </tr>
      <tr>
        <td>F. Emicrania, cefalea</td>
        <td><label><input type="radio" name="additional_symptom_F" value="0"></label></td>
        <td><label><input type="radio" name="additional_symptom_F" value="1"></label></td>
      </tr>
    </table>
  </form>

  <p>4- I sintomi delle domande 2 e 3 e il dolore diffuso sono stati avvertiti per almeno tre mesi?</p>
  <label><input type="radio" name="duration" value="Si"> Sì</label>
  <label><input type="radio" name="duration" value="No"> No</label>

  <p>5- E' presente una patologia che può motivare il dolore avvertito?</p>
  <label><input type="radio" name="other_pathology" value="Si"> Sì</label>
  <label><input type="radio" name="other_pathology" value="No"> No</label>
</div>
<hr>

<div class="question-section">
  <p class="score">Punteggio Totale: <span id="total-score">0</span> /31</p>
  <p class="diagnosis-result">Criteri soddisfatti: <span id="diagnosis-text">Nessun risultato</span></p>
</div>

<script>
  function calculateWPI() {
    const checkboxes = document.querySelectorAll('#fibromyalgia-form input[type="checkbox"]');
    let score = 0;
    checkboxes.forEach(checkbox => {
      if (checkbox.checked) {
        score++;
      }
    });
    document.getElementById('wpi-score').innerText = score;
    updateTotalScore();
  }

  function calculateSSS() {
    const radioGroups = document.querySelectorAll('#sss-form input[type="radio"]');
    let score = 0;
    // Iterate over the radio buttons in groups based on their name
    const symptomNames = ['symptom_A', 'symptom_B', 'symptom_C'];
    symptomNames.forEach(name => {
      const selectedRadio = document.querySelector(`input[name="${name}"]:checked`);
      if (selectedRadio) {
        score += parseInt(selectedRadio.value);
      }
    });
    document.getElementById('sss-score').innerText = score;
    updateTotalScore();
  }

  function checkDiagnosisCriteria() {
    const wpiScore = parseInt(document.getElementById('wpi-score').innerText);
    const sssScore = parseInt(document.getElementById('sss-score').innerText);
    const hasDuration = document.querySelector('input[name="duration"][value="Si"]').checked;
    
    let diagnosisText = document.getElementById('diagnosis-text');
    let result = false;

    // Check if the duration criteria is met
    if (hasDuration) {
      // Check for WPI >= 7 AND SSS >= 5
      if (wpiScore >= 7 && sssScore >= 5) {
        result = true;
      } 
      // Check for WPI between 4-6 AND SSS >= 9
      else if (wpiScore >= 4 && wpiScore <= 6 && sssScore >= 9) {
        result = true;
      }
    }
    
    if (result) {
      diagnosisText.innerText = "RISPETTATI";
      diagnosisText.className = "diagnosis-met";
    } else {
      diagnosisText.innerText = "NON RISPETTATI";
      diagnosisText.className = "diagnosis-not-met";
    }
  }

  function updateTotalScore() {
    const wpiScore = parseInt(document.getElementById('wpi-score').innerText);
    const sssScore = parseInt(document.getElementById('sss-score').innerText);
    const totalScore = wpiScore + sssScore;
    document.getElementById('total-score').innerText = totalScore;
    checkDiagnosisCriteria();
  }

  document.querySelectorAll('#fibromyalgia-form input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', calculateWPI);
  });

  document.querySelectorAll('#sss-form input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', calculateSSS);
  });
  
  document.querySelectorAll('input[name="duration"]').forEach(radio => {
    radio.addEventListener('change', checkDiagnosisCriteria);
  });
</script>

</body>
</html>
